# GDALバッチツール (WPF)

本リポジトリは、フォルダを再帰スキャンして TIF/SHP/GeoJSON のメタ情報を取得し、一覧表示やCSV/JSON へのエクスポート、さらに EPSG 付与・EPSG 変換・アルファ/定数バンド追加を一括実行できる WPF アプリケーションです。

## ビルド手順

1. [.NET 8 SDK](https://dotnet.microsoft.com/) をインストール
2. Visual Studio 2022 で `GisApp.sln` を開く
3. NuGet パッケージを復元
4. ビルドして実行 (x64)

GDAL は `MaxRev.Gdal.*` パッケージにより同梱されているため、別途インストールは不要です。必要に応じて Visual C++ 再頒布パッケージが求められる場合があります。

## 使い方

1. メニュー「フォルダ選択」で対象ディレクトリを指定
2. 「スキャン」で再帰的に TIF/SHP/GeoJSON を読み込み、メタ情報を一覧表示
3. 必要に応じて「CSV保存」「JSON保存」でエクスポート
4. 左ペインで処理モードと EPSG 等を設定し、「処理開始」で一括処理

処理結果は `<選択フォルダ>/out` に相対パス構造を保って出力されます。

### 処理オプション

- **EPSG付与** : 既存データの座標値はそのままに、SRS 情報を付与します。
- **EPSG変換** : 指定した EPSG に座標変換します。ラスタは GDAL.Warp、ベクタは VectorTranslate を使用。
- **バンド操作** : ラスタにアルファバンドを追加、または定数値バンドを追加します。

### 注意点

- Shapefile では `.prj` のみ出力します。`.cpg` 等は必要に応じて手動で処理してください。
- GeoJSON の SRS はレイヤに設定されますが、ビューアによっては認識されない場合があります。
- 大容量ラスタではメモリ使用量に注意してください。

## テスト

`GisApp.Tests` プロジェクトにて、EPSG 判定や出力パス生成等のユニットテストを提供しています。

## サンプルデータ

`scripts/gen_sample_data.py` を使用すると、簡易的な GeoJSON/TIFF のダミーデータを生成できます。

```
python scripts/gen_sample_data.py sample
```

## ライセンス

MIT
